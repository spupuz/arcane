// Vulnerability types for frontend
export type VulnerabilitySeverity = 'UNKNOWN' | 'LOW' | 'MEDIUM' | 'HIGH' | 'CRITICAL';
export type VulnerabilityScanStatus = 'pending' | 'scanning' | 'completed' | 'failed';

export interface CVSSInfo {
	v2Score?: number;
	v3Score?: number;
	v2Vector?: string;
	v3Vector?: string;
}

export interface Vulnerability {
	vulnerabilityId: string;
	pkgName: string;
	installedVersion: string;
	fixedVersion?: string;
	severity: VulnerabilitySeverity;
	title?: string;
	description?: string;
	references?: string[];
	cvss?: CVSSInfo;
	publishedDate?: string;
	lastModifiedDate?: string;
}

export interface VulnerabilityWithImage extends Vulnerability {
	imageId: string;
	imageName: string;
}

export interface SeveritySummary {
	critical: number;
	high: number;
	medium: number;
	low: number;
	unknown: number;
	total: number;
}

export interface EnvironmentVulnerabilitySummary {
	totalImages: number;
	scannedImages: number;
	summary?: SeveritySummary;
}

export interface VulnerabilityScanResult {
	imageId: string;
	imageName: string;
	scanTime: string;
	status: VulnerabilityScanStatus;
	summary?: SeveritySummary;
	vulnerabilities?: Vulnerability[];
	error?: string;
	duration?: number;
	scannerVersion?: string;
}

export interface VulnerabilityScanSummary {
	imageId: string;
	scanTime: string;
	status: VulnerabilityScanStatus;
	summary?: SeveritySummary;
	error?: string;
}

export interface ScanSummariesRequest {
	imageIds: string[];
}

export interface ScanSummariesResponse {
	summaries: Record<string, VulnerabilityScanSummary | undefined>;
}

export interface ScannerStatus {
	available: boolean;
	version?: string;
}

export interface IgnoreVulnerabilityPayload {
	imageId: string;
	vulnerabilityId: string;
	pkgName: string;
	installedVersion: string;
	reason?: string;
}

export interface IgnoredVulnerability {
	id: string;
	environmentId: string;
	imageId: string;
	vulnerabilityId: string;
	pkgName: string;
	installedVersion: string;
	reason?: string;
	createdBy: string;
	createdAt: string;
}
